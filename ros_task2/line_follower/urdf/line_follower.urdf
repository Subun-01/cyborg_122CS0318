<?xml version="1.0" encoding="utf-8"?>

  <robot
    name="line_follower">
     <gazebo reference="base_link">
      <material>Gazebo/Red</material>
    </gazebo>


    <link
      name="base_link">
      <inertial>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <mass
          value="17.077406139337" />
        <inertia
          ixx="0.352414234716794"
          ixy="6.99585429874466E-05"
          ixz="0.0254948458561002"
          iyy="0.919591127482344"
          iyz="1.23872342186172E-05"
          izz="1.21412510283381" />
      </inertial>
      <visual>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/base_link.STL" />
        </geometry>
        <material
          name="">
          <color
            rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
        </material>
      </visual>
      <collision>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/base_link.STL" />
        </geometry>
      </collision>
    </link>
    <link
      name="right_link">
      <inertial>
        <origin
          xyz="0.000167903430802641 -0.00972937072003544 0.000566972495614215"
          rpy="0 0 0" />
        <mass
          value="3.18587695163445" />
        <inertia
          ixx="0.0132350714812642"
          ixy="-8.01815850795183E-08"
          ixz="6.88956172348682E-05"
          iyy="0.0215472303608317"
          iyz="-2.70754614250006E-07"
          izz="0.0134473138664706" />
      </inertial>
      <visual>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/right_link.STL" />
        </geometry>
        <material
          name="">
          <color
            rgba="0.529411764705882 0.549019607843137 0.549019607843137 1" />
        </material>
      </visual>
      <collision>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/right_link.STL" />
        </geometry>
      </collision>
    </link>
    <joint
      name="right_joint"
      type="continuous">
      <origin
        xyz="0.4 0.39292 -0.076"
        rpy="0 0 0" />
      <parent
        link="base_link" />
      <child
        link="right_link" />
      <axis
        xyz="0 1 0" />
      <limit
        effort="1"
        velocity="1" />
    </joint>
    <link
      name="left_link">
      <inertial>
        <origin
          xyz="0.000372901594120845 0.0095238516940765 0.00045890497269091"
          rpy="0 0 0" />
        <mass
          value="3.18587695163444" />
        <inertia
          ixx="0.0133153059020803"
          ixy="-1.78077319847682E-07"
          ixz="0.00012384744099151"
          iyy="0.0215472303608315"
          iyz="-2.19147475185428E-07"
          izz="0.0133670794456544" />
      </inertial>
      <visual>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/left_link.STL" />
        </geometry>
        <material
          name="">
          <color
            rgba="0.529411764705882 0.549019607843137 0.549019607843137 1" />
        </material>
      </visual>
      <collision>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/left_link.STL" />
        </geometry>
      </collision>
    </link>
    <joint
      name="left_joint"
      type="continuous">
      <origin
        xyz="0.4 -0.39231 -0.076"
        rpy="0 0 0" />
      <parent
        link="base_link" />
      <child
        link="left_link" />
      <axis
        xyz="0 1 0" />
      <limit
        effort="1"
        velocity="1" />
    </joint>
    <link
      name="caster_link">
      <inertial>
        <origin
          xyz="-0.00863793610964621 -0.000731875926583359 -0.039577183115354"
          rpy="0 0 0" />
        <mass
          value="0.393804040513477" />
        <inertia
          ixx="0.000163761928642377"
          ixy="1.40462826865338E-06"
          ixz="-2.90717934854712E-05"
          iyy="0.000147209359571156"
          iyz="-2.46795156065587E-06"
          izz="0.000188494753687385" />
      </inertial>
      <visual>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/caster_link.STL" />
        </geometry>
        <material
          name="">
          <color
            rgba="0.529411764705882 0.549019607843137 0.549019607843137 1" />
        </material>
      </visual>
      <collision>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/caster_link.STL" />
        </geometry>
      </collision>
    </link>
    <joint
      name="caster_joint"
      type="continuous">
      <origin
        xyz="-0.405 0.00030435 -0.115"
        rpy="0 0 0" />
      <parent
        link="base_link" />
      <child
        link="caster_link" />
      <axis
        xyz="0 0 -1" />
      <limit
        effort="1"
        velocity="1" />
    </joint>
    <link
      name="caster_link_1">
      <inertial>
        <origin
          xyz="0 -5.55111512312578E-17 0"
          rpy="0 0 0" />
        <mass
          value="0.138183465537126" />
        <inertia
          ixx="6.60370952409757E-05"
          ixy="-3.85070446538693E-06"
          ixz="-8.90654324687392E-22"
          iyy="0.000111151859149466"
          iyz="1.05103599338664E-20"
          izz="6.5710784191043E-05" />
      </inertial>
      <visual>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/caster_link_1.STL" />
        </geometry>
        <material
          name="">
          <color
            rgba="0.298039215686275 0.298039215686275 0.298039215686275 1" />
        </material>
      </visual>
      <collision>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/caster_link_1.STL" />
        </geometry>
      </collision>
    </link>
    <joint
      name="caster_joint_1"
      type="continuous">
      <origin
        xyz="-0.031466 -0.0026665 -0.082746"
        rpy="0 0 0" />
      <parent
        link="caster_link" />
      <child
        link="caster_link_1" />
      <axis
        xyz="-0.084438 0.99643 0" />
      <limit
        effort="1"
        velocity="1" />
    </joint>
    <link
      name="camera_link">
      <inertial>
        <origin
          xyz="0.0120021143823427 0 -0.00817668591653353"
          rpy="0 0 0" />
        <mass
          value="0.0899154863762026" />
        <inertia
          ixx="7.84084393997471E-05"
          ixy="-3.01384248132955E-21"
          ixz="-4.89164419382936E-07"
          iyy="2.3370735734999E-05"
          iyz="1.76224122725081E-20"
          izz="6.41503787185048E-05" />
      </inertial>
      <visual>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/camera_link.STL" />
        </geometry>
        <material
          name="">
          <color
            rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
        </material>
      </visual>
      <collision>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="package://line_follower/meshes/camera_link.STL" />
        </geometry>
      </collision>
    </link>
    <joint
      name="camera_joint"
      type="fixed">
      <origin
        xyz="-0.13429 0 0.58025"
        rpy="0 0.05236 0" />
      <parent
        link="base_link" />
      <child
        link="camera_link" />
      <axis
        xyz="0 0 0" />
      <limit
        effort="0"
        velocity="0" />
    </joint>

     <gazebo>
      <plugin name="differential_drive_controller" filename="libgazebo_ros_diff_drive.so">

        <!-- Plugin update rate in Hz -->
        <updateRate>100</updateRate>

        <!-- Name of left joint, defaults to `left_joint` -->
        <leftJoint>left_joint</leftJoint>

        <!-- Name of right joint, defaults to `right_joint` -->
        <rightJoint>right_joint</rightJoint>

        <!-- The distance from the center of one wheel to the other, in meters, defaults to 0.34 m -->
        <wheelSeparation>0.5380</wheelSeparation>

        <!-- Diameter of the wheels, in meters, defaults to 0.15 m -->
        <wheelDiameter>0.2410</wheelDiameter>

        <!-- Wheel acceleration, in rad/s^2, defaults to 0.0 rad/s^2 -->
        <!-- <wheelAcceleration>1.0</wheelAcceleration> -->

        <!-- Maximum torque which the wheels can produce, in Nm, defaults to 5 Nm -->
        <wheelTorque>20</wheelTorque>

        <!-- Topic to receive geometry_msgs/Twist message commands, defaults to `cmd_vel` -->
        <commandTopic>cmd_vel</commandTopic>

        <!-- Topic to publish nav_msgs/Odometry messages, defaults to `odom` -->
        <odometryTopic>odom</odometryTopic>

        <!-- Odometry frame, defaults to `odom` -->
        <odometryFrame>odom</odometryFrame>

        <!-- Robot frame to calculate odometry from, defaults to `base_footprint` -->
        <robotBaseFrame>base_link</robotBaseFrame>

        <!-- Odometry source, 0 for ENCODER, 1 for WORLD, defaults to WORLD -->
        <odometrySource>1</odometrySource>

        <!-- Set to true to publish transforms for the wheel links, defaults to false -->
        <publishWheelTF>true</publishWheelTF>

        <!-- Set to true to publish transforms for the odometry, defaults to true -->
        <publishOdom>true</publishOdom>

        <!-- Set to true to publish sensor_msgs/JointState on /joint_states for the wheel joints, defaults to false -->
        <publishWheelJointState>true</publishWheelJointState>

        <!-- Set to true to swap right and left wheels, defaults to true -->
        <legacyMode>false</legacyMode>
      </plugin>
    </gazebo>


    <gazebo reference="camera_link">
    <sensor type="camera" name="camera1">
      <update_rate>30.0</update_rate>
      <camera name="head">
        <horizontal_fov>1.3962634</horizontal_fov>
        <image>
          <width>800</width>
          <height>800</height>
          <format>R8G8B8</format>
        </image>
        <clip>
          <near>0.02</near>
          <far>300</far>
        </clip>
        <noise>
          <type>gaussian</type>
          <!-- Noise is sampled independently per pixel on each frame.
               That pixel's noise value is added to each of its color
               channels, which at that point lie in the range [0,1]. -->
          <mean>0.0</mean>
          <stddev>0.007</stddev>
        </noise>
      </camera>
      <plugin name="camera_controller" filename="libgazebo_ros_camera.so">
        <alwaysOn>true</alwaysOn>
        <updateRate>0.0</updateRate>
        <cameraName>rrbot/camera1</cameraName>
        <imageTopicName>image_raw</imageTopicName>
        <cameraInfoTopicName>camera_info</cameraInfoTopicName>
        <frameName>camera_link</frameName>
        <hackBaseline>0.07</hackBaseline>
        <distortionK1>0.0</distortionK1>
        <distortionK2>0.0</distortionK2>
        <distortionK3>0.0</distortionK3>
        <distortionT1>0.0</distortionT1>
        <distortionT2>0.0</distortionT2>
      </plugin>
    </sensor>
  </gazebo>


  </robot>